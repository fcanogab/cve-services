FROM ubuntu:xenial

LABEL \
    mitre.name=cveawg \
    mitre.project=cveawg \
    mitre.maintainer=cpaynerogers@mitre.org

# mongo installation prerequisites
RUN apt-get update && apt-get install -y \
        apt-transport-https \
        ca-certificates \
        wget

# install specific version of mongo following the steps in the
# MongoDB 3.6 installation guide for Ubuntu
RUN wget --no-check-certificate -qO - https://www.mongodb.org/static/pgp/server-3.6.asc | apt-key add -
RUN echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.6 multiverse" | \
    tee /etc/apt/sources.list.d/mongodb-org-3.6.list
RUN apt-get update
RUN apt-get install -y \
        mongodb-org=3.6.20 \
        mongodb-org-server=3.6.20 \
        mongodb-org-shell=3.6.20 \
        mongodb-org-mongos=3.6.20 \
        mongodb-org-tools=3.6.20

# mongo will look for its data directory
RUN mkdir -p /data/db

EXPOSE 27017
ENTRYPOINT /usr/bin/mongod
